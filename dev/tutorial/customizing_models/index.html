<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Customizing models · LifeSimulator.jl</title><meta name="title" content="Customizing models · LifeSimulator.jl"/><meta property="og:title" content="Customizing models · LifeSimulator.jl"/><meta property="twitter:title" content="Customizing models · LifeSimulator.jl"/><meta name="description" content="Documentation for LifeSimulator.jl."/><meta property="og:description" content="Documentation for LifeSimulator.jl."/><meta property="twitter:description" content="Documentation for LifeSimulator.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">LifeSimulator.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../getting_started/">Getting started</a></li><li class="is-active"><a class="tocitem" href>Customizing models</a><ul class="internal"><li><a class="tocitem" href="#Mortality-model"><span>Mortality model</span></a></li><li><a class="tocitem" href="#Lapse-model"><span>Lapse model</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Customizing models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Customizing models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="github.com/JuliaActuary/LifeSimulator.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaActuary/LifeSimulator.jl/blob/main/docs/src/tutorial/customizing_models.jl#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Customizing-models"><a class="docs-heading-anchor" href="#Customizing-models">Customizing models</a><a id="Customizing-models-1"></a><a class="docs-heading-anchor-permalink" href="#Customizing-models" title="Permalink"></a></h1><p>LifeSimulator.jl is designed to allow users to provide their own models. Notably, custom models for mortality and lapses may be specified, to allow for a more realistic parametrization than the default values. On the longer term, it might be possible to bundle common interfaces for whole <a href="../../reference/#LifeSimulator.Model"><code>Model</code></a>s, but we haven&#39;t explored enough insurance products to be able to design a cohesive interface between different types of products. Curently, we have a very basic categorization of insurance product models into <a href="https://en.wikipedia.org/wiki/Term_life_insurance">term life</a> and <a href="https://en.wikipedia.org/wiki/Universal_life_insurance">universal life</a> models (via the types <a href="../../reference/#LifeSimulator.TermLifeModel"><code>TermLifeModel</code></a> and <a href="../../reference/#LifeSimulator.UniversalLifeModel"><code>UniversalLifeModel</code></a>). These don&#39;t represent all the types of insurance models, and have a single implementation with limited functionality at the moment, <a href="../../reference/#LifeSimulator.LifelibBasiclife"><code>LifelibBasiclife</code></a> and <a href="../../reference/#LifeSimulator.LifelibSavings"><code>LifelibSavings</code></a> (greatly inspired by <a href="https://lifelib.io/">lifelib</a>, as their name suggests).</p><p>Nonetheless, these insurance models allow us to carry out simulations and produce reasonable data, and even more so with custom mortality and lapse models.</p><h2 id="Mortality-model"><a class="docs-heading-anchor" href="#Mortality-model">Mortality model</a><a id="Mortality-model-1"></a><a class="docs-heading-anchor-permalink" href="#Mortality-model" title="Permalink"></a></h2><p>Mortality models are defined as subtypes of <a href="../../reference/#LifeSimulator.MortalityModel"><code>MortalityModel</code></a>. Documentation for this abstract type reveals that we need to extend <a href="../../reference/#LifeSimulator.monthly_mortality_rate"><code>monthly_mortality_rate</code></a> or <a href="../../reference/#LifeSimulator.annual_mortality_rate"><code>annual_mortality_rate</code></a>, whichever we prefer.</p><p>Let&#39;s create our own mortality model which believes that female individuals are immortal and that men very frequently die. After creating a basic <code>struct</code>, we extend <a href="../../reference/#LifeSimulator.annual_mortality_rate"><code>annual_mortality_rate</code></a> with the corresponding logic:</p><pre><code class="language-julia hljs">using LifeSimulator, Dates

Base.@kwdef struct SexDiscriminatingMortality &lt;: MortalityModel
  annual_rate::Float64 = 0.4
end

function LifeSimulator.annual_mortality_rate(model::SexDiscriminatingMortality, ::Month, policy::Policy)
  if policy.sex == FEMALE
    0.0
  else
    model.annual_rate
  end
end</code></pre><p>We can now try to simulate using this model and see how that affects the population after 5 years:</p><pre><code class="language-julia hljs">mortality = SexDiscriminatingMortality()
lapse = ConstantLapse(0.0) # this ensures all policy decrements are due to deaths
model = LifelibBasiclife(; mortality, lapse)
policies = [
  PolicySet(Policy(sex = MALE), 100),
  PolicySet(Policy(sex = FEMALE), 100),
]
sim = simulate(model, policies, 60)

male, female = sim.active_policies
(male.count, female.count)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(7.776000000000018, 100.0)</code></pre><h2 id="Lapse-model"><a class="docs-heading-anchor" href="#Lapse-model">Lapse model</a><a id="Lapse-model-1"></a><a class="docs-heading-anchor-permalink" href="#Lapse-model" title="Permalink"></a></h2><p>Similarly to mortality models, lapse models are defined as subtypes of a <a href="../../reference/#LifeSimulator.LapseModel"><code>LapseModel</code></a> abstract type. We also need to implement a method to compute an annual or monthly lapse rate, but this time the default is not to associate lapse rates to individual policies for performance reasons. Instead, if we wish to do so, we will have to specify <code>rates_are_per_policy(model::MyModel) = true</code>. Let&#39;s define a model that thinks only females lapse their contracts, and with a very high default probability:</p><pre><code class="language-julia hljs">Base.@kwdef struct SexDiscriminatingLapse &lt;: LapseModel
  annual_rate::Float64 = 0.7
end

function LifeSimulator.annual_lapse_rate(model::SexDiscriminatingLapse, ::Month, policy::Policy)
  if policy.sex == MALE
    0.0
  else
    model.annual_rate
  end
end

LifeSimulator.rates_are_per_policy(::SexDiscriminatingLapse) = true</code></pre><p>Let&#39;s see this in action:</p><pre><code class="language-julia hljs">mortality = ConstantMortality(0.0) # this ensures all policy decrements are due to lapses
lapse = SexDiscriminatingLapse()
model = LifelibBasiclife(; mortality, lapse)
policies = [
  PolicySet(Policy(sex = MALE), 100),
  PolicySet(Policy(sex = FEMALE), 100),
]
sim = simulate(model, policies, 60)

male, female = sim.active_policies
(male.count, female.count)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(100.0, 0.24300000000000035)</code></pre><p>Of course, we can customize both mortality and lapse models at the same time:</p><pre><code class="language-julia hljs">mortality = SexDiscriminatingMortality()
lapse = SexDiscriminatingLapse()
model = LifelibBasiclife(; mortality, lapse)
policies = [
  PolicySet(Policy(sex = MALE), 100),
  PolicySet(Policy(sex = FEMALE), 100),
]
sim = simulate(model, policies, 60)

male, female = sim.active_policies
(male.count, female.count)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(7.776000000000018, 0.24300000000000035)</code></pre><p>And this also works with the <a href="../../reference/#LifeSimulator.LifelibSavings"><code>LifelibSavings</code></a> model:</p><pre><code class="language-julia hljs">model = LifelibSavings(; mortality, lapse)
sim = simulate(model, policies, 60)

male, female = sim.active_policies
(male.count, female.count)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(7.776000000000018, 0.24300000000000035)</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../getting_started/">« Getting started</a><a class="docs-footer-nextpage" href="../../reference/">Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.1 on <span class="colophon-date" title="Sunday 22 October 2023 18:50">Sunday 22 October 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
