<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Getting started · LifeSimulator.jl</title><meta name="title" content="Getting started · LifeSimulator.jl"/><meta property="og:title" content="Getting started · LifeSimulator.jl"/><meta property="twitter:title" content="Getting started · LifeSimulator.jl"/><meta name="description" content="Documentation for LifeSimulator.jl."/><meta property="og:description" content="Documentation for LifeSimulator.jl."/><meta property="twitter:description" content="Documentation for LifeSimulator.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">LifeSimulator.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Getting started</a></li></ul></li><li><a class="tocitem" href="../../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Getting started</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Getting started</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="github.com/JuliaActuary/LifeSimulator.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaActuary/LifeSimulator.jl/blob/main/docs/src/tutorial/getting_started.jl#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Getting-started"><a class="docs-heading-anchor" href="#Getting-started">Getting started</a><a id="Getting-started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-started" title="Permalink"></a></h1><p>Let&#39;s run a few simulations to get a feel of the package functionality.</p><p>First, we have to choose a <a href="../../reference/#LifeSimulator.Model"><code>Model</code></a> to simulate. There are a few to choose from, essentially divided in two categories: <a href="../../reference/#LifeSimulator.TermLifeModel"><code>TermLifeModel</code></a>s, representing <a href="https://en.wikipedia.org/wiki/Term_life_insurance">term life insurance</a>, and <a href="../../reference/#LifeSimulator.UniversalLifeModel"><code>UniversalLifeModel</code></a>s, representing <a href="https://en.wikipedia.org/wiki/Universal_life_insurance">universal life insurance</a>. For this example, we will take a simple term life model based on <a href="https://github.com/lifelib-dev/lifelib">lifelib</a>, reimplemented in Julia. There are two implementations we can choose from: a memoized implementation, and an iterative implementation. The memoized implementation replicates 1:1 the design of the corresponding Python library, and has a less polished interface. For this reason, we will take the iterative implementation, <a href="../../reference/#LifeSimulator.LifelibBasiclife"><code>LifelibBasiclife</code></a>, which will allow us to showcase most of the data structures relevant in context of this package.</p><pre><code class="language-julia hljs">using LifeSimulator, Dates
model = LifelibBasiclife()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LifelibBasiclife{ExplicitMortality}(ExplicitMortality([0.0002310671048780701 0.0002541738153658771 … 0.0003383053482519825 0.0003721358830771808; 0.0002353200126583699 0.000258852013924207 … 0.0003445320305331195 0.0003789852335864315; … ; 1.0 1.0 … 1.0 1.0; 1.0 1.0 … 1.0 1.0]), 0.5, 300.0, 60.0, 0.6, 0.01, [0.0, 0.00555, 0.006840000000000001, 0.00788, 0.00866, 0.00937, 0.00997, 0.0105, 0.01098, 0.01144  …  0.02984, 0.02992, 0.03001, 0.03009, 0.03017, 0.03025, 0.03033000000000001, 0.03041000000000001, 0.03049, 0.03056000000000001])</code></pre><p>Second, we define a bunch of policies that we want to simulate forward in time. Such policies represent life insurance products. Ideally, we would simulate individual products, that is, separate contracts for different customers. However, for efficiency and scalability reasons, such insurance products are implemented as sets of products. That is, a contract is weighted by a number of customers holding this type of contract. those are called [<code>PolicySet</code>]s. We can generate some randomly using <code>Base.rand</code>:</p><pre><code class="language-julia hljs">rand(PolicySet, 500)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">500-element Vector{PolicySet}:
 PolicySet(Policy(FEMALE, Dates.Year(70), true, 568275.0, 478584.0, Dates.Month(0), Dates.Year(13), LifeSimulator.Product(LifeSimulator.PREMIUM_LEVEL, nothing, 0.1), 0.0), 316.8)
 PolicySet(Policy(MALE, Dates.Year(48), true, 661651.0, 598132.0, Dates.Month(0), Dates.Year(12), LifeSimulator.Product(LifeSimulator.PREMIUM_LEVEL, 3, 0.05), 0.0), 417.8)
 PolicySet(Policy(FEMALE, Dates.Year(32), false, 444779.0, 403796.0, Dates.Month(0), Dates.Year(7), LifeSimulator.Product(LifeSimulator.PREMIUM_SINGLE, nothing, 0.0), 0.0), 835.2)
 PolicySet(Policy(MALE, Dates.Year(69), false, 452988.0, 412118.0, Dates.Month(0), Dates.Year(19), LifeSimulator.Product(LifeSimulator.PREMIUM_SINGLE, nothing, 0.0), 0.0), 581.9)
 PolicySet(Policy(MALE, Dates.Year(56), false, 611976.0, 512316.0, Dates.Month(0), Dates.Year(14), LifeSimulator.Product(LifeSimulator.PREMIUM_SINGLE, nothing, 0.0), 0.0), 213.5)
 PolicySet(Policy(FEMALE, Dates.Year(26), true, 510801.0, 460451.0, Dates.Month(0), Dates.Year(18), LifeSimulator.Product(LifeSimulator.PREMIUM_LEVEL, 3, 0.05), 0.0), 538.5)
 PolicySet(Policy(FEMALE, Dates.Year(39), false, 467901.0, 411366.0, Dates.Month(0), Dates.Year(11), LifeSimulator.Product(LifeSimulator.PREMIUM_SINGLE, 1, 0.0), 0.0), 556.8)
 PolicySet(Policy(MALE, Dates.Year(56), true, 524363.0, 496186.0, Dates.Month(0), Dates.Year(20), LifeSimulator.Product(LifeSimulator.PREMIUM_LEVEL, 3, 0.05), 0.0), 776.3)
 PolicySet(Policy(MALE, Dates.Year(70), false, 655535.0, 586535.0, Dates.Month(0), Dates.Year(7), LifeSimulator.Product(LifeSimulator.PREMIUM_SINGLE, 1, 0.0), 0.0), 314.0)
 PolicySet(Policy(MALE, Dates.Year(31), true, 496895.0, 452901.0, Dates.Month(0), Dates.Year(12), LifeSimulator.Product(LifeSimulator.PREMIUM_LEVEL, nothing, 0.1), 0.0), 346.9)
 ⋮
 PolicySet(Policy(FEMALE, Dates.Year(53), true, 396261.0, 349319.0, Dates.Month(0), Dates.Year(19), LifeSimulator.Product(LifeSimulator.PREMIUM_LEVEL, nothing, 0.1), 0.0), 222.5)
 PolicySet(Policy(FEMALE, Dates.Year(27), true, 692864.0, 645999.0, Dates.Month(0), Dates.Year(9), LifeSimulator.Product(LifeSimulator.PREMIUM_LEVEL, nothing, 0.1), 0.0), 885.7)
 PolicySet(Policy(FEMALE, Dates.Year(42), true, 502739.0, 408197.0, Dates.Month(0), Dates.Year(20), LifeSimulator.Product(LifeSimulator.PREMIUM_LEVEL, 3, 0.05), 0.0), 576.9)
 PolicySet(Policy(MALE, Dates.Year(45), false, 479646.0, 393743.0, Dates.Month(0), Dates.Year(9), LifeSimulator.Product(LifeSimulator.PREMIUM_SINGLE, nothing, 0.0), 0.0), 969.8)
 PolicySet(Policy(MALE, Dates.Year(50), false, 614261.0, 589318.0, Dates.Month(0), Dates.Year(16), LifeSimulator.Product(LifeSimulator.PREMIUM_SINGLE, nothing, 0.0), 0.0), 793.7)
 PolicySet(Policy(FEMALE, Dates.Year(20), true, 665962.0, 632361.0, Dates.Month(0), Dates.Year(9), LifeSimulator.Product(LifeSimulator.PREMIUM_LEVEL, 3, 0.05), 0.0), 54.8)
 PolicySet(Policy(MALE, Dates.Year(41), false, 481850.0, 461961.0, Dates.Month(0), Dates.Year(6), LifeSimulator.Product(LifeSimulator.PREMIUM_SINGLE, nothing, 0.0), 0.0), 450.0)
 PolicySet(Policy(MALE, Dates.Year(31), true, 350166.0, 317514.0, Dates.Month(0), Dates.Year(12), LifeSimulator.Product(LifeSimulator.PREMIUM_LEVEL, nothing, 0.1), 0.0), 721.8)
 PolicySet(Policy(FEMALE, Dates.Year(54), true, 540821.0, 508180.0, Dates.Month(0), Dates.Year(20), LifeSimulator.Product(LifeSimulator.PREMIUM_LEVEL, 3, 0.05), 0.0), 418.9)</code></pre><p>But for this example, we&#39;ll use a small set of fixed policies to guarantee the consistency of results across runs (which will allow us to reliably interpret what we obtain). We&#39;ll stick to the default values for the most part.</p><pre><code class="language-julia hljs">policies = [
  PolicySet(Policy(term = Year(20), age = Year(20), premium = 200_000), 100),
  PolicySet(Policy(term = Year(20), age = Year(45), premium = 600_000), 80),
  PolicySet(Policy(term = Year(10), age = Year(70), premium = 400_000), 50),
]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{PolicySet}:
 PolicySet(Policy(MALE, Dates.Year(20), false, 500000.0, 200000.0, Dates.Month(0), Dates.Year(20), LifeSimulator.Product(LifeSimulator.PREMIUM_SINGLE, nothing, 0.0), 0.0), 100.0)
 PolicySet(Policy(MALE, Dates.Year(45), false, 500000.0, 600000.0, Dates.Month(0), Dates.Year(20), LifeSimulator.Product(LifeSimulator.PREMIUM_SINGLE, nothing, 0.0), 0.0), 80.0)
 PolicySet(Policy(MALE, Dates.Year(70), false, 500000.0, 400000.0, Dates.Month(0), Dates.Year(10), LifeSimulator.Product(LifeSimulator.PREMIUM_SINGLE, nothing, 0.0), 0.0), 50.0)</code></pre><p>Now that we have a model and policies to evolve over time, we can carry out a simulation using <a href="../../reference/#LifeSimulator.simulate-Tuple{Any, Model, Any, Int64}"><code>simulate</code></a> over a specified time range.</p><p>First, as we&#39;re just experimenting, we can simulate a single step and print what happened during that time. The data structure that will be provided to our custom callback function will be a <a href="../../reference/#LifeSimulator.SimulationEvents"><code>SimulationEvents</code></a>, and we can just print it out for now.</p><pre><code class="language-julia hljs">n = 1 # number of timesteps
simulate(model, policies, n) do events
  println(sprint(show, MIME&quot;text/plain&quot;(), events))
end;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SimulationEvents:
● Time range: months 0 to 1
● Total deaths: 0.020593317125309207 over 3 policy sets
● Total lapses: 2.0103905008136698 over 3 policy sets
● Number of policies starting at the beginning of month 0: 230.0
● Policy expirations: 0.0 (0 policy sets)
● Claims: 10296.658562654604
● Expenses: 69000.0</code></pre><p>This <a href="../../reference/#LifeSimulator.SimulationEvents"><code>SimulationEvents</code></a> data structure has information about deaths, lapses, new and expired policies, claims and expenses. This is all useful to compute cash flows and miscellaneous costs involved for the insurance company providing the insurance products.</p><p>In fact, the computation of cash flows is usually the main point of interest of such simulations, which warranted its implementation in this package: enters <a href="../../reference/#LifeSimulator.CashFlow"><code>CashFlow</code></a>.</p><p>Now, instead of printing the raw <a href="../../reference/#LifeSimulator.SimulationEvents"><code>SimulationEvents</code></a>, we can print the associated <a href="../../reference/#LifeSimulator.CashFlow"><code>CashFlow</code></a> quite simply:</p><pre><code class="language-julia hljs">simulate(model, policies, n) do events
  cf = CashFlow(events, model)
  println(&quot;Net cash flow: &quot;, cf.net)
end;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Net cash flow: -79296.6585626546</code></pre><p>We got a negative cashflow, from the perspective of the insurance company. Why is that? In our model, establishing new contracts (policies) has a fixed cost, which is part of the expenses reported by the <a href="../../reference/#LifeSimulator.SimulationEvents"><code>SimulationEvents</code></a> during printing earlier.</p><p>But note that we only computed cash flows due to the various events that occurred during the simulation. We have not computed cash flows related to active policies, and therefore, our value for the net cash flow is incomplete! Let&#39;s fix that. We will need to manually build a <a href="../../reference/#LifeSimulator.Simulation"><code>Simulation</code></a> object so we can reference during the computation of cash flows, and use <a href="../../reference/#LifeSimulator.simulate!-Tuple{Any, Simulation, Int64}"><code>simulate!</code></a> to mutate this simulation in-place. Note that the <a href="../../reference/#LifeSimulator.simulate-Tuple{Any, Model, Any, Int64}"><code>simulate</code></a> function essentially does the same thing, it&#39;s just that it won&#39;t give you access to the simulation object itself.</p><pre><code class="language-julia hljs">simulation = Simulation(model, policies)
simulate!(simulation, n) do events
  cf = CashFlow(simulation) # premiums, policy upkeep costs, commissions
  cf += CashFlow(events, model) # claims, costs for new policies
  println(&quot;Net cash flow: &quot;, cf.net)
end;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Net cash flow: 3.480843762510099e7</code></pre><p>Note how the net cashflow is now positive: the premiums balance out the costs incurred by policy acquisitions to the insurance company, as well as claims made during that period.</p><p>Instead of building a <code>Simulation</code>, and then computing cash flows manually, convenience functions are provided when the sole interest of the simulation is to compute cash flows:</p><pre><code class="language-julia hljs">n = 5
CashFlow(model, policies, n)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CashFlow(4.322903323147551e8, 0.0, 50568.99052968451, 74658.64094130522, 2.5937419938885307e8, 0.0, 1.7279090529443106e8, 1.7279090529443106e8)</code></pre><pre><code class="language-julia hljs">CashFlow(model, policies, n) do cashflow
  println(&quot;Net cash flow: &quot;, cashflow.net)
end;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Net cash flow: 3.511955334143735e7
Net cash flow: 3.48775298783109e7
Net cash flow: 3.456925586991397e7
Net cash flow: 3.426370700749882e7
Net cash flow: 3.396085919727001e7</code></pre><p>For term life insurance products, it will be normal for the company to have a decreasing revenue over time, as the premium remains fixed while mortality increases. An exception is typically made for the first year, during which commissions to agents are generally paid a large percentage of the premium.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../../reference/">Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.0 on <span class="colophon-date" title="Sunday 8 October 2023 17:10">Sunday 8 October 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
